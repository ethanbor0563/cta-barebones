<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Upcoming Trains</title>
<style>
    body {
        margin: 0;
        font-family: Arial, sans-serif;
        background-color: #f4f4f4;
    }
    header {
        background-color: #1976d2;
        color: white;
        text-align: center;
        padding: 1rem;
        font-size: 1.5rem;
    }
    .container {
        max-width: 600px;
        margin: 2rem auto;
        position: relative;
        height: 400px;
        overflow: hidden;
        padding-right: 10px; /* fix right cut-off */
    }
    .card {
        position: absolute;
        left: 0;
        width: calc(100% - 10px); /* fix right cut-off */
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 1rem;
        color: white;
        border-radius: 10px;
        box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        transform: translateY(100%);
        opacity: 0;
        transition: transform 1s ease, opacity 1s ease;
    }
    .countdown {
        font-weight: bold;
        font-size: 1.2rem;
        padding: 0.3rem 0.6rem;
        border-radius: 10px;
        min-width: 60px;
        text-align: center;
    }
</style>
</head>
<body>
<header>Upcoming Trains</header>
<div class="container" id="train-list"></div>

<script>
const container = document.getElementById('train-list');
let trains = [];
const cardHeight = 80;

function randomTrain() {
    const directions = ['North','South'];
    const lines = ['Red','Purple'];
    const etaMinutes = Math.floor(Math.random()*20)+1;
    const etaSeconds = Math.floor(Math.random()*60);
    const now = new Date();
    const eta = new Date(now.getTime() + etaMinutes*60000 + etaSeconds*1000);
    const line = lines[Math.floor(Math.random()*lines.length)];
    return {direction: directions[Math.floor(Math.random()*directions.length)], line, eta};
}

function getLineColor(line){
    if(line==='Red') return '#d32f2f';
    if(line==='Purple') return '#6a1b9a';
    return '#1976d2';
}

function createCard(train, index){
    const card = document.createElement('div');
    card.className = 'card';
    card.style.backgroundColor = getLineColor(train.line);
    card.style.transform = `translateY(${index*cardHeight}px)`;
    card.innerHTML = `<div>${train.line} Line - ${train.direction}bound | ETA: ${train.eta.toLocaleTimeString([], {hour:'2-digit', minute:'2-digit'})}</div><div class='countdown'></div>`;
    container.appendChild(card);
    requestAnimationFrame(()=>{ card.style.opacity='1'; });
    return card;
}

let cardElements = [];

function renderInitial(){
    trains = Array.from({length:5}, randomTrain);
    trains.forEach((t,i)=>{
        cardElements.push(createCard(t,i));
    });
}

function updateCountdowns(){
    const now = new Date();
    cardElements.forEach((card,i)=>{
        const eta = trains[i].eta;
        let diff = Math.max(0,Math.floor((eta-now)/1000));
        const minutes = Math.floor(diff/60);
        const seconds = diff%60;
        card.querySelector('.countdown').innerText=`${minutes}m ${seconds}s`;
    });
}

function arriveTrain(){
    const firstCard = cardElements.shift();
    firstCard.style.opacity='0';
    firstCard.style.transform = `translateY(-120%)`;

    trains.shift();

    // Move existing cards up
    cardElements.forEach((card,i)=>{
        card.style.transform = `translateY(${i*cardHeight}px)`;
    });

    // Add new card after transition
    setTimeout(()=>{
        container.removeChild(firstCard);
        const newTrain = randomTrain();
        trains.push(newTrain);
        const newCard = createCard(newTrain, cardElements.length);
        cardElements.push(newCard);
    }, 1000); // match transition duration
}

renderInitial();
updateCountdowns();
setInterval(updateCountdowns,1000);
setInterval(arriveTrain,30000);
</script>
</body>
</html>
